#!/usr/bin/env node

/*!
 * Rammer JavaScript Library v0.0.8
 * https://github.com/trysd/npm-rammer#readme
 * Released under the MIT license
 *
 * Date: 2023-01-12T19:49Z
 */
'use strict';

var fs = require('fs-extra');
var uuid = require('uuid');
var readline = require('readline');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

function _interopNamespace(e) {
    if (e && e.__esModule) return e;
    var n = Object.create(null);
    if (e) {
        Object.keys(e).forEach(function (k) {
            if (k !== 'default') {
                var d = Object.getOwnPropertyDescriptor(e, k);
                Object.defineProperty(n, k, d.get ? d : {
                    enumerable: true,
                    get: function () { return e[k]; }
                });
            }
        });
    }
    n["default"] = e;
    return Object.freeze(n);
}

var fs__namespace = /*#__PURE__*/_interopNamespace(fs);
var readline__default = /*#__PURE__*/_interopDefaultLegacy(readline);

function __spreadArray(to, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
    if (ar || !(i in from)) {
      if (!ar) ar = Array.prototype.slice.call(from, 0, i);
      ar[i] = from[i];
    }
  }
  return to.concat(ar || Array.prototype.slice.call(from));
}

var MFile = /** @class */ (function () {
    function MFile() {
    }
    /**
     * Get recursive directory structure
     * @param dirPath
     * @param res
     * @param route
     * @returns
     */
    MFile.readDir = function (dirPath, res, route) {
        var _this = this;
        if (res === void 0) { res = []; }
        if (route === void 0) { route = []; }
        var routesStr = (route.length ? route.join('/') + '/' : '');
        var dirent = fs__namespace.readdirSync(dirPath + '/' + routesStr, { withFileTypes: true });
        dirent.forEach(function (d) {
            if (d.isDirectory()) {
                _this.readDir(dirPath, res, __spreadArray(__spreadArray([], route, true), [d.name], false));
            }
            else {
                res.push(routesStr + d.name);
            }
        });
        return res;
    };
    return MFile;
}());

var base = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
var MBase64 = /** @class */ (function () {
    function MBase64() {
    }
    MBase64.btoa = function (str) {
        return Array.from(new TextEncoder().encode(str))
            .map(function (x) { return x.toString(2).padStart(8, "0"); })
            .join("")
            .padEnd(Math.ceil(str.length * 8 / 6) * 6, "0")
            .split(/(.{6})/)
            .filter(function (x) { return x; })
            .map(function (x) { return base[parseInt(x, 2)]; })
            .join("");
    };
    MBase64.atob = function (e) {
        var t = e.replace(/=/g, "").split(""), res = new Uint8Array(6 * t.length / 8), connect = 0, unit = 0;
        return t.forEach(function (e, t) {
            var x = base.indexOf(e), mod = t % 4;
            if (0 === mod) {
                connect = x << 2;
                return;
            }
            var f = 6 - 2 * mod;
            connect += x >>> f,
                res[unit] = connect,
                unit++,
                connect = (x << 8 - f) % 256;
        }), res;
    };
    return MBase64;
}());

var CommandLine = /** @class */ (function () {
    function CommandLine(commandLine) {
        this.commandLine = [];
        this.commandLine = commandLine;
    }
    CommandLine.prototype.main = function () {
        var options = this.commandLine.map(function (m) { return m.match(/^-/) ? m : null; }).filter(function (f) { return f != null; });
        var targets = this.commandLine.filter(function (f) { return !f.match(/^-/); }).slice(2, 4);
        if (options.includes('--decode')) {
            this.unrammer(options, targets);
        }
        else {
            this.rammer(options, targets);
        }
    };
    CommandLine.prototype.unrammer = function (options, targets) {
        console.log(options, targets);
        var readRammerFile = targets[0];
        var writeBaseDir = targets[1];
        var active = false;
        var td = new TextDecoder();
        readline__default["default"].createInterface({ input: fs__namespace.createReadStream(readRammerFile) }).on('line', function (li) {
            if (!active && li === 'format=txt') {
                active = true;
            }
            else if (active) {
                console.log(li);
                var fb = li.split(':');
                var fileName = td.decode(MBase64.atob(fb[0]));
                var body = td.decode(MBase64.atob(fb[1]));
                console.log(writeBaseDir + '/' + fileName);
                console.log(body);
                fs__namespace.outputFileSync('./' + writeBaseDir + '/' + fileName, body);
            }
        });
    };
    CommandLine.prototype.rammer = function (options, targets) {
        var readDir = targets[0];
        var tempFile = './~tmp.' + uuid.v4();
        var writeFile = targets[1];
        var fileList = MFile.readDir(readDir, [], []);
        //
        // header
        //
        var header = function () {
            if (options.includes('--type-js')) {
                fs__namespace.appendFileSync(tempFile, 'var file = {};\n');
            }
            else if (options.includes('--type-ts')) {
                fs__namespace.appendFileSync(tempFile, 'const _files: { [key in IFiles]: string } = {\n');
            }
            else {
                fs__namespace.appendFileSync(tempFile, 'format=txt\n');
            }
        };
        fs__namespace.removeSync(writeFile);
        header();
        //
        // body
        //
        fileList.forEach(function (f, i) {
            console.log("execute(".concat(fileList.length, "/").concat(i + 1, "): ").concat(targets[0] + "/" + f));
            var mStr = fs__namespace.readFileSync(targets[0] + "/" + f).toString();
            if (options.includes('--type-js')) {
                fs__namespace.appendFileSync(tempFile, "files[\"".concat(f, "\"] = \"").concat(MBase64.btoa(mStr), "\";\n"));
            }
            else if (options.includes('--type-ts')) {
                fs__namespace.appendFileSync(tempFile, "  \"".concat(f, "\": \"").concat(MBase64.btoa(mStr), "\"").concat(fileList.length - 1 == i ? '' : ',', "\n"));
            }
            else {
                fs__namespace.appendFileSync(tempFile, "".concat(MBase64.btoa(f), ":").concat(MBase64.btoa(mStr), "\n"));
            }
        });
        //
        // footer
        //
        var footer = function () {
            if (options.includes('--type-js')) {
                fs__namespace.appendFileSync(tempFile, 'module.exports = file;');
            }
            else if (options.includes('--type-ts')) {
                var c = (targets[1] + '')
                    .replace(/^.*?([^\/]+)$/, '$1')
                    .replace(/^(.+?)\.[^\.]+?$/, '$1')
                    .replace(/-[a-z0-9]/, function (a) { return a.replace(/-/, '').toUpperCase(); })
                    .replace(/^[a-z]/, function (a) { return a.toUpperCase(); });
                fs__namespace.appendFileSync(tempFile, "};\n\nexport type IFiles = \n".concat(fileList.map(function (m) { return "  \"".concat(m, "\""); }).join(' |\n'), ";\n\nexport class ").concat(c, " {\n  public static get(fileName: IFiles): string {\n    return new TextDecoder().decode(XAfter.decodeBase64(_files[fileName]));\n  }\n  public static getFileNameList(): string[] {\n    return Object.keys(_files);\n  }\n  public static getFiles() {\n    return _files;\n  }\n  public static decodeBase64(e: string): Uint8Array {\n    let t = e.replace(/=/g, \"\").split(\"\"), l = new Uint8Array(6 * t.length / 8), n = 0, r = 0;\n    return t.forEach((e, t) => { let x = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".indexOf(e), c = t % 4; if (0 === c) { n = x << 2; return } let f = 6 - 2 * c; n += x >>> f, l[r] = n, r++, n = (x << 8 - f) % 256 }), l\n  }\n}"));
            }
        };
        footer();
        // fs.copyFileSync(tempFile, writeFile);
        // fs.removeSync(tempFile);
        fs__namespace.renameSync(tempFile, writeFile);
        console.log('done.');
        var size = fs__namespace.statSync(writeFile).size;
        if (size < 1024) {
            console.log('total size:', fs__namespace.statSync(writeFile).size, 'B');
        }
        else if (size < 1024 * 1024) {
            console.log('total size:', (fs__namespace.statSync(writeFile).size / 1024).toFixed(3), 'KB');
        }
        else {
            console.log('total size:', (fs__namespace.statSync(writeFile).size / 1024 / 1024).toFixed(3), 'MB');
        }
        console.log("".concat(fileList.length, " files into \"").concat(writeFile, "\" were rammed."));
    };
    return CommandLine;
}());

new CommandLine(process.argv).main();

module.exports = CommandLine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uLy4uL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCIuLi8uLi9zcmMvTUZpbGUudHMiLCIuLi8uLi9zcmMvTUJhc2U2NC50cyIsIi4uLy4uL3NyYy9jb21tYW5kLWxpbmUudHMiLCIuLi8uLi9zcmMvYmluL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XHJcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xyXG4gICAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xyXG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIG8pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XHJcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgc3RhdGUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHJlYWQgcHJpdmF0ZSBtZW1iZXIgZnJvbSBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIGtpbmQgPT09IFwibVwiID8gZiA6IGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyKSA6IGYgPyBmLnZhbHVlIDogc3RhdGUuZ2V0KHJlY2VpdmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgc2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEluKHN0YXRlLCByZWNlaXZlcikge1xyXG4gICAgaWYgKHJlY2VpdmVyID09PSBudWxsIHx8ICh0eXBlb2YgcmVjZWl2ZXIgIT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHJlY2VpdmVyICE9PSBcImZ1bmN0aW9uXCIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHVzZSAnaW4nIG9wZXJhdG9yIG9uIG5vbi1vYmplY3RcIik7XHJcbiAgICByZXR1cm4gdHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciA9PT0gc3RhdGUgOiBzdGF0ZS5oYXMocmVjZWl2ZXIpO1xyXG59XHJcbiIsImltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzLWV4dHJhJztcblxuZXhwb3J0IGNsYXNzIE1GaWxlIHtcblxuICAvKipcbiAgICogR2V0IHJlY3Vyc2l2ZSBkaXJlY3Rvcnkgc3RydWN0dXJlXG4gICAqIEBwYXJhbSBkaXJQYXRoIFxuICAgKiBAcGFyYW0gcmVzIFxuICAgKiBAcGFyYW0gcm91dGUgXG4gICAqIEByZXR1cm5zIFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyByZWFkRGlyKGRpclBhdGg6IHN0cmluZywgcmVzOiBzdHJpbmdbXSA9IFtdLCByb3V0ZTogc3RyaW5nW10gPSBbXSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByb3V0ZXNTdHIgPSAocm91dGUubGVuZ3RoID8gcm91dGUuam9pbignLycpICsgJy8nIDogJycpO1xuICAgIGNvbnN0IGRpcmVudCA9IGZzLnJlYWRkaXJTeW5jKGRpclBhdGggKyAnLycgKyByb3V0ZXNTdHIsIHsgd2l0aEZpbGVUeXBlczogdHJ1ZSB9KTtcbiAgICBkaXJlbnQuZm9yRWFjaChkID0+IHtcbiAgICAgIGlmIChkLmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgdGhpcy5yZWFkRGlyKGRpclBhdGgsIHJlcywgWy4uLnJvdXRlLCBkLm5hbWVdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcy5wdXNoKHJvdXRlc1N0ciArIGQubmFtZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlcztcbiAgfVxuXG59XG4iLCJjb25zdCBiYXNlID0gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvXCI7XG5cbmV4cG9ydCBjbGFzcyBNQmFzZTY0IHtcblxuICBwdWJsaWMgc3RhdGljIGJ0b2Eoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBBcnJheS5mcm9tKG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzdHIpKVxuICAgICAgLm1hcCh4ID0+IHgudG9TdHJpbmcoMikucGFkU3RhcnQoOCwgXCIwXCIpKVxuICAgICAgLmpvaW4oXCJcIilcbiAgICAgIC5wYWRFbmQoTWF0aC5jZWlsKHN0ci5sZW5ndGggKiA4IC8gNikgKiA2LCBcIjBcIilcbiAgICAgIC5zcGxpdCgvKC57Nn0pLylcbiAgICAgIC5maWx0ZXIoeCA9PiB4KVxuICAgICAgLm1hcCh4ID0+IGJhc2VbcGFyc2VJbnQoeCwgMildKVxuICAgICAgLmpvaW4oXCJcIilcbiAgfTtcblxuICBwdWJsaWMgc3RhdGljIGF0b2IoZTogc3RyaW5nKTogVWludDhBcnJheSB7XG4gICAgbGV0IHQgPSBlLnJlcGxhY2UoLz0vZywgXCJcIikuc3BsaXQoXCJcIiksXG4gICAgICByZXMgPSBuZXcgVWludDhBcnJheSg2ICogdC5sZW5ndGggLyA4KSxcbiAgICAgIGNvbm5lY3QgPSAwLFxuICAgICAgdW5pdCA9IDA7XG4gICAgcmV0dXJuIHQuZm9yRWFjaCgoZSwgdCkgPT4ge1xuICAgICAgbGV0IHggPSBiYXNlLmluZGV4T2YoZSksXG4gICAgICBtb2QgPSB0ICUgNDtcbiAgICAgIGlmICgwID09PSBtb2QpIHtcbiAgICAgICAgY29ubmVjdCA9IHggPDwgMjsgcmV0dXJuXG4gICAgICB9XG4gICAgICBsZXQgZiA9IDYgLSAyICogbW9kO1xuICAgICAgY29ubmVjdCArPSB4ID4+PiBmLFxuICAgICAgcmVzW3VuaXRdID0gY29ubmVjdCxcbiAgICAgIHVuaXQrKyxcbiAgICAgIGNvbm5lY3QgPSAoeCA8PCA4IC0gZikgJSAyNTZcbiAgICB9KSwgcmVzXG4gIH07XG5cbn1cbiIsImltcG9ydCB7IE1GaWxlIH0gZnJvbSBcIi4vTUZpbGVcIjtcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzLWV4dHJhJztcbmltcG9ydCB7IE1CYXNlNjQgfSBmcm9tIFwiLi9NQmFzZTY0XCI7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCByZWFkbGluZSBmcm9tICdyZWFkbGluZSc7XG5cbmV4cG9ydCBjbGFzcyBDb21tYW5kTGluZSB7XG5cbiAgcHJpdmF0ZSBjb21tYW5kTGluZTogc3RyaW5nW10gPSBbXTtcblxuICBjb25zdHJ1Y3Rvcihjb21tYW5kTGluZTogc3RyaW5nW10pIHtcbiAgICB0aGlzLmNvbW1hbmRMaW5lID0gY29tbWFuZExpbmU7XG4gIH1cblxuICBwdWJsaWMgbWFpbigpOiB2b2lkIHtcbiAgICBjb25zdCBvcHRpb25zID0gdGhpcy5jb21tYW5kTGluZS5tYXAobSA9PiBtLm1hdGNoKC9eLS8pID8gbSA6IG51bGwpLmZpbHRlcihmID0+IGYgIT0gbnVsbCkgYXMgc3RyaW5nW107XG4gICAgY29uc3QgdGFyZ2V0czogc3RyaW5nW10gPSB0aGlzLmNvbW1hbmRMaW5lLmZpbHRlcihmID0+ICFmLm1hdGNoKC9eLS8pKS5zbGljZSgyLCA0KSBhcyBzdHJpbmdbXTtcblxuICAgIGlmIChvcHRpb25zLmluY2x1ZGVzKCctLWRlY29kZScpKSB7XG4gICAgICB0aGlzLnVucmFtbWVyKG9wdGlvbnMsIHRhcmdldHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJhbW1lcihvcHRpb25zLCB0YXJnZXRzKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVucmFtbWVyKG9wdGlvbnM6IHN0cmluZ1tdLCB0YXJnZXRzOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKG9wdGlvbnMsIHRhcmdldHMpO1xuICAgIGNvbnN0IHJlYWRSYW1tZXJGaWxlID0gdGFyZ2V0c1swXSBhcyBzdHJpbmc7XG4gICAgY29uc3Qgd3JpdGVCYXNlRGlyID0gdGFyZ2V0c1sxXSBhcyBzdHJpbmc7XG4gICAgbGV0IGFjdGl2ZSA9IGZhbHNlO1xuICAgIGNvbnN0IHRkID0gbmV3IFRleHREZWNvZGVyKCk7XG4gICAgcmVhZGxpbmUuY3JlYXRlSW50ZXJmYWNlKHsgaW5wdXQ6IGZzLmNyZWF0ZVJlYWRTdHJlYW0ocmVhZFJhbW1lckZpbGUpIH0pLm9uKCdsaW5lJywgKGxpKSA9PiB7XG4gICAgICBpZiAoIWFjdGl2ZSAmJiBsaSA9PT0gJ2Zvcm1hdD10eHQnKSB7XG4gICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICB9IGVsc2UgaWYgKGFjdGl2ZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhsaSk7XG4gICAgICAgIGNvbnN0IGZiID0gbGkuc3BsaXQoJzonKTtcbiAgICAgICAgY29uc3QgZmlsZU5hbWUgPSB0ZC5kZWNvZGUoTUJhc2U2NC5hdG9iKGZiWzBdIGFzIHN0cmluZykpO1xuICAgICAgICBjb25zdCBib2R5ID0gdGQuZGVjb2RlKE1CYXNlNjQuYXRvYihmYlsxXSBhcyBzdHJpbmcpKTtcbiAgICAgICAgY29uc29sZS5sb2cod3JpdGVCYXNlRGlyICsgJy8nICsgZmlsZU5hbWUpXG4gICAgICAgIGNvbnNvbGUubG9nKGJvZHkpO1xuICAgICAgICBmcy5vdXRwdXRGaWxlU3luYygnLi8nICsgd3JpdGVCYXNlRGlyICsgJy8nICsgZmlsZU5hbWUsIGJvZHkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIH1cblxuICBwcml2YXRlIHJhbW1lcihvcHRpb25zOiBzdHJpbmdbXSwgdGFyZ2V0czogc3RyaW5nW10pOiB2b2lkIHtcbiAgICBjb25zdCByZWFkRGlyID0gdGFyZ2V0c1swXSBhcyBzdHJpbmc7XG4gICAgY29uc3QgdGVtcEZpbGUgPSAnLi9+dG1wLicgKyB1dWlkdjQoKTtcbiAgICBjb25zdCB3cml0ZUZpbGUgPSB0YXJnZXRzWzFdIGFzIHN0cmluZztcbiAgICBjb25zdCBmaWxlTGlzdCA9IE1GaWxlLnJlYWREaXIocmVhZERpciwgW10sIFtdKTtcblxuICAgIC8vXG4gICAgLy8gaGVhZGVyXG4gICAgLy9cbiAgICBjb25zdCBoZWFkZXIgPSAoKSA9PiB7XG4gICAgICBpZiAob3B0aW9ucy5pbmNsdWRlcygnLS10eXBlLWpzJykpIHtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmModGVtcEZpbGUsIFxuICAgICAgICAgICd2YXIgZmlsZSA9IHt9O1xcbidcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG9wdGlvbnMuaW5jbHVkZXMoJy0tdHlwZS10cycpKSB7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHRlbXBGaWxlLCBcbiAgICAgICAgICAnY29uc3QgX2ZpbGVzOiB7IFtrZXkgaW4gSUZpbGVzXTogc3RyaW5nIH0gPSB7XFxuJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHRlbXBGaWxlLCBcbiAgICAgICAgICAnZm9ybWF0PXR4dFxcbidcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZnMucmVtb3ZlU3luYyh3cml0ZUZpbGUpO1xuICAgIGhlYWRlcigpO1xuXG4gICAgLy9cbiAgICAvLyBib2R5XG4gICAgLy9cbiAgICBmaWxlTGlzdC5mb3JFYWNoKChmLCBpKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgZXhlY3V0ZSgke2ZpbGVMaXN0Lmxlbmd0aH0vJHtpICsgMX0pOiAke3RhcmdldHNbMF0gKyBcIi9cIiArIGZ9YCk7XG4gICAgICBjb25zdCBtU3RyID0gZnMucmVhZEZpbGVTeW5jKHRhcmdldHNbMF0gKyBcIi9cIiArIGYpLnRvU3RyaW5nKCk7XG4gICAgICBpZiAob3B0aW9ucy5pbmNsdWRlcygnLS10eXBlLWpzJykpIHtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmModGVtcEZpbGUsIFxuICAgICAgICAgIGBmaWxlc1tcIiR7Zn1cIl0gPSBcIiR7TUJhc2U2NC5idG9hKG1TdHIpfVwiO1xcbmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG9wdGlvbnMuaW5jbHVkZXMoJy0tdHlwZS10cycpKSB7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHRlbXBGaWxlLCBcbiAgICAgICAgICBgICBcIiR7Zn1cIjogXCIke01CYXNlNjQuYnRvYShtU3RyKX1cIiR7ZmlsZUxpc3QubGVuZ3RoIC0gMSA9PSBpID8gJycgOiAnLCd9XFxuYFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHRlbXBGaWxlLCBcbiAgICAgICAgICBgJHtNQmFzZTY0LmJ0b2EoZil9OiR7TUJhc2U2NC5idG9hKG1TdHIpfVxcbmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy9cbiAgICAvLyBmb290ZXJcbiAgICAvL1xuICAgIGNvbnN0IGZvb3RlciA9ICgpID0+IHtcbiAgICAgIGlmIChvcHRpb25zLmluY2x1ZGVzKCctLXR5cGUtanMnKSkge1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyh0ZW1wRmlsZSwgXG4gICAgICAgICAgJ21vZHVsZS5leHBvcnRzID0gZmlsZTsnXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChvcHRpb25zLmluY2x1ZGVzKCctLXR5cGUtdHMnKSkge1xuICAgICAgICBjb25zdCBjID0gKHRhcmdldHNbMV0gKyAnJylcbiAgICAgICAgLnJlcGxhY2UoL14uKj8oW15cXC9dKykkLywgJyQxJylcbiAgICAgICAgLnJlcGxhY2UoL14oLis/KVxcLlteXFwuXSs/JC8sICckMScpXG4gICAgICAgIC5yZXBsYWNlKC8tW2EtejAtOV0vLCBmdW5jdGlvbihhKSB7IHJldHVybiBhLnJlcGxhY2UoLy0vLCAnJykudG9VcHBlckNhc2UoKSB9KVxuICAgICAgICAucmVwbGFjZSgvXlthLXpdLywgZnVuY3Rpb24oYSkgeyByZXR1cm4gYS50b1VwcGVyQ2FzZSgpIH0pO1xuXG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHRlbXBGaWxlLCBgfTtcblxuZXhwb3J0IHR5cGUgSUZpbGVzID0gXFxuJHtmaWxlTGlzdC5tYXAobSA9PiBgICBcIiR7bX1cImApLmpvaW4oJyB8XFxuJyl9O1xuXG5leHBvcnQgY2xhc3MgJHtjfSB7XG4gIHB1YmxpYyBzdGF0aWMgZ2V0KGZpbGVOYW1lOiBJRmlsZXMpOiBzdHJpbmcge1xuICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoWEFmdGVyLmRlY29kZUJhc2U2NChfZmlsZXNbZmlsZU5hbWVdKSk7XG4gIH1cbiAgcHVibGljIHN0YXRpYyBnZXRGaWxlTmFtZUxpc3QoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhfZmlsZXMpO1xuICB9XG4gIHB1YmxpYyBzdGF0aWMgZ2V0RmlsZXMoKSB7XG4gICAgcmV0dXJuIF9maWxlcztcbiAgfVxuICBwdWJsaWMgc3RhdGljIGRlY29kZUJhc2U2NChlOiBzdHJpbmcpOiBVaW50OEFycmF5IHtcbiAgICBsZXQgdCA9IGUucmVwbGFjZSgvPS9nLCBcIlwiKS5zcGxpdChcIlwiKSwgbCA9IG5ldyBVaW50OEFycmF5KDYgKiB0Lmxlbmd0aCAvIDgpLCBuID0gMCwgciA9IDA7XG4gICAgcmV0dXJuIHQuZm9yRWFjaCgoZSwgdCkgPT4geyBsZXQgeCA9IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrL1wiLmluZGV4T2YoZSksIGMgPSB0ICUgNDsgaWYgKDAgPT09IGMpIHsgbiA9IHggPDwgMjsgcmV0dXJuIH0gbGV0IGYgPSA2IC0gMiAqIGM7IG4gKz0geCA+Pj4gZiwgbFtyXSA9IG4sIHIrKywgbiA9ICh4IDw8IDggLSBmKSAlIDI1NiB9KSwgbFxuICB9XG59YFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH07XG4gICAgZm9vdGVyKCk7XG5cbiAgICAvLyBmcy5jb3B5RmlsZVN5bmModGVtcEZpbGUsIHdyaXRlRmlsZSk7XG4gICAgLy8gZnMucmVtb3ZlU3luYyh0ZW1wRmlsZSk7XG4gICAgZnMucmVuYW1lU3luYyh0ZW1wRmlsZSwgd3JpdGVGaWxlKTtcblxuICAgIGNvbnNvbGUubG9nKCdkb25lLicpO1xuICAgIGNvbnN0IHNpemUgPSBmcy5zdGF0U3luYyh3cml0ZUZpbGUpLnNpemU7XG4gICAgaWYgKHNpemUgPCAxMDI0KSB7XG4gICAgICBjb25zb2xlLmxvZygndG90YWwgc2l6ZTonLCBmcy5zdGF0U3luYyh3cml0ZUZpbGUpLnNpemUsICdCJyk7XG4gICAgfSBlbHNlIGlmIChzaXplIDwgMTAyNCAqIDEwMjQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCd0b3RhbCBzaXplOicsIChmcy5zdGF0U3luYyh3cml0ZUZpbGUpLnNpemUgLyAxMDI0KS50b0ZpeGVkKDMpLCAnS0InKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ3RvdGFsIHNpemU6JywgKGZzLnN0YXRTeW5jKHdyaXRlRmlsZSkuc2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDMpLCAnTUInKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coYCR7ZmlsZUxpc3QubGVuZ3RofSBmaWxlcyBpbnRvIFwiJHt3cml0ZUZpbGV9XCIgd2VyZSByYW1tZWQuYCk7XG5cbiAgfVxuXG59XG4iLCJpbXBvcnQgeyBDb21tYW5kTGluZSB9IGZyb20gJy4uL2NvbW1hbmQtbGluZSc7XG5uZXcgQ29tbWFuZExpbmUocHJvY2Vzcy5hcmd2KS5tYWluKCk7XG5leHBvcnQgZGVmYXVsdCBDb21tYW5kTGluZTtcbiJdLCJuYW1lcyI6WyJfX3NwcmVhZEFycmF5IiwidG8iLCJmcm9tIiwicGFjayIsImFyZ3VtZW50cyIsImxlbmd0aCIsImkiLCJsIiwiYXIiLCJBcnJheSIsInByb3RvdHlwZSIsInNsaWNlIiwiY2FsbCIsImNvbmNhdCIsImZzIiwicmVhZGxpbmUiLCJ1dWlkdjQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBd0tPLFNBQVNBLGFBQWEsQ0FBQ0MsRUFBRSxFQUFFQyxJQUFJLEVBQUVDLElBQUksRUFBRTtBQUMxQyxFQUFBLElBQUlBLElBQUksSUFBSUMsU0FBUyxDQUFDQyxNQUFNLEtBQUssQ0FBQyxFQUFFLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUMsQ0FBQyxHQUFHTCxJQUFJLENBQUNHLE1BQU0sRUFBRUcsRUFBRSxFQUFFRixDQUFDLEdBQUdDLENBQUMsRUFBRUQsQ0FBQyxFQUFFLEVBQUU7QUFDakYsSUFBQSxJQUFJRSxFQUFFLElBQUksRUFBRUYsQ0FBQyxJQUFJSixJQUFJLENBQUMsRUFBRTtBQUNwQixNQUFBLElBQUksQ0FBQ00sRUFBRSxFQUFFQSxFQUFFLEdBQUdDLEtBQUssQ0FBQ0MsU0FBUyxDQUFDQyxLQUFLLENBQUNDLElBQUksQ0FBQ1YsSUFBSSxFQUFFLENBQUMsRUFBRUksQ0FBQyxDQUFDLENBQUE7QUFDcERFLE1BQUFBLEVBQUUsQ0FBQ0YsQ0FBQyxDQUFDLEdBQUdKLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUE7QUFDbkIsS0FBQTtBQUNKLEdBQUE7QUFDQSxFQUFBLE9BQU9MLEVBQUUsQ0FBQ1ksTUFBTSxDQUFDTCxFQUFFLElBQUlDLEtBQUssQ0FBQ0MsU0FBUyxDQUFDQyxL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
